<ion-header>
  <ion-navbar>
    <ion-buttons end >
      <button ion-button icon-only color="royal" (click)="onToolbarMapClick()" *ngIf="showMapWithInToolbar">
        <ion-icon name="map"></ion-icon>
      </button>

       <button ion-button icon-only color="royal" (click)="onToolbarSearchClick()">
        <ion-icon name="search"></ion-icon>
      </button>
    </ion-buttons>
    <ion-title *ngIf="dataset">{{dataset._name}}</ion-title>
  </ion-navbar>
</ion-header>


<ion-content>

    <ion-refresher (ionRefresh)="doRefresh($event)">
      <!-- <ion-refresher-content pullingIcon="arrow-dropdown" pullingText="Pull to refresh" refreshingSpinner="circles" refreshingText="Refreshing..."> -->
      <ion-refresher-content pullingIcon="arrow-dropdown" refreshingSpinner="circles" refreshingText="{{ 'page_records_list_refreshing_text' | translate }}">
      </ion-refresher-content>
    </ion-refresher>

  <ion-list *ngIf="records && records.length > 0 else emptyTemplate">
    <ion-card *ngFor="let record of records" (click)="onRecordClicked(record)">

      <ion-item>
        <ion-avatar item-start>
          <img src="assets/imgs/ic_avatar_circle_gray.png">
        </ion-avatar>
        <h2>{{record._createdby}}</h2>
        <p>{{record._createdon | date: 'dd/MM/yyyy'}}</p>
      </ion-item>
    
      <img *ngIf="record._main_image" src="{{record._main_image}}" class="record-list-image">
    
      <ion-card-content>

        <!-- title -->
        <ion-card-title *ngIf="!record._title; else templateTitle" class="truncate">
          <!-- title not valid -->
          {{record._id}}
        </ion-card-title>
        <!-- title valid -->
        <ng-template #templateTitle>
          <ion-card-title class="truncate"> {{record._title}}</ion-card-title>
        </ng-template>

        <!-- tags -->
        <!-- <p *ngIf="record.tags">tags: {{record.tags}}</p> -->
      
        <!-- description -->
        <p class="truncate-block" *ngIf="record._description">{{record._description}}</p>
      
      </ion-card-content>
    
    </ion-card>


    <ion-infinite-scroll (ionInfinite)="doInfinite($event)">
      <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="{{ 'page_records_list_loading_data' | translate }}">
      </ion-infinite-scroll-content>
    </ion-infinite-scroll>
  </ion-list>

  <ng-template #emptyTemplate>
    <ion-card-title class="truncate" padding> 
     {{ 'page_records_list_data_unavailable' | translate }}
    </ion-card-title>
  </ng-template>
</ion-content>